<div class="max-w-4xl mx-auto" *ngIf="table$ | async as table">
  <div *ngIf="order$ | async as order">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="mb-6 flex items-center justify-between">
      <div>
        <button
          (click)="goBack()"
          class="text-blue-600 hover:text-blue-700 mb-2 flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          –ù–∞–∑–∞–¥ –∫ —Å—Ç–æ–ª–∏–∫–∞–º
        </button>
        <h1 class="text-3xl font-bold text-gray-800">
          –ó–∞–∫–∞–∑ –¥–ª—è —Å—Ç–æ–ª–∞ {{ table.number }}
        </h1>
        <p class="text-gray-600 mt-1">–ó–∞–∫–∞–∑ #{{ order.id }}</p>
      </div>
      <div class="text-right">
        <div class="text-sm text-gray-600">–û—Ñ–∏—Ü–∏–∞–Ω—Ç</div>
        <div class="text-lg font-semibold">{{ order.waiterName || '–ù–µ —É–∫–∞–∑–∞–Ω' }}</div>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞ -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4 flex items-center justify-between">
        <span>–ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞</span>
        <button
          (click)="addItems()"
          class="text-sm bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ
        </button>
      </h2>

      <!-- –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –ø—É—Å—Ç–æ–π -->
      <div *ngIf="order.items.length === 0" class="text-center py-12 text-gray-500">
        <div class="text-6xl mb-4">üçΩÔ∏è</div>
        <p class="text-lg mb-4">–ó–∞–∫–∞–∑ –ø—É—Å—Ç–æ–π</p>
        <button
          (click)="addItems()"
          class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition"
        >
          –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –±–ª—é–¥–æ
        </button>
      </div>

      <!-- –°–ø–∏—Å–æ–∫ –±–ª—é–¥ -->
      <div *ngIf="order.items.length > 0" class="space-y-3">
        <div
          *ngFor="let item of order.items"
          class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition"
        >
          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª—é–¥–µ -->
          <div class="flex-1">
            <div class="font-semibold text-gray-800">{{ item.name }}</div>
            <div class="text-sm text-gray-600">{{ formatPrice(item.price) }} √ó {{ item.quantity }}</div>
            <div *ngIf="item.notes" class="text-xs text-gray-500 mt-1 italic">
              üí¨ {{ item.notes }}
            </div>
          </div>

          <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º -->
          <div class="flex items-center gap-3">
            <div class="flex items-center gap-2 bg-white rounded-lg px-2 py-1 shadow-sm">
              <button
                (click)="updateQuantity(order.id, item.id, -1)"
                class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition"
              >
                ‚àí
              </button>
              <span class="w-8 text-center font-semibold">{{ item.quantity }}</span>
              <button
                (click)="updateQuantity(order.id, item.id, 1)"
                class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-green-600 hover:bg-green-50 rounded transition"
              >
                +
              </button>
            </div>

            <!-- –°—É–º–º–∞ -->
            <div class="w-24 text-right font-semibold text-gray-800">
              {{ formatPrice(item.subtotal) }}
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
            <button
              (click)="removeItem(order.id, item.id)"
              class="w-8 h-8 flex items-center justify-center text-red-600 hover:bg-red-50 rounded transition"
              title="–£–¥–∞–ª–∏—Ç—å"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –∏ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-center justify-between mb-6 pb-4 border-b">
        <span class="text-xl font-semibold text-gray-700">–ò—Ç–æ–≥–æ:</span>
        <span class="text-3xl font-bold text-gray-900">
          {{ formatPrice(order.totalAmount) }}
        </span>
      </div>

      <div class="flex gap-3">
        <button
          (click)="addItems()"
          class="flex-1 bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition font-medium"
        >
          –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ
        </button>
        <button
          (click)="closeOrder(order)"
          [disabled]="order.items.length === 0"
          class="flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition font-medium"
        >
          –ó–∞–∫—Ä—ã—Ç—å –∑–∞–∫–∞–∑ –∏ –∫ –æ–ø–ª–∞—Ç–µ
        </button>
      </div>
    </div>
  </div>

  <!-- –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω -->
  <div *ngIf="!(order$ | async)" class="text-center py-16">
    <div class="text-6xl mb-4">‚ùå</div>
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω</h2>
    <button
      (click)="goBack()"
      class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition"
    >
      –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–æ–ª–∏–∫–∞–º
    </button>
  </div>
</div>

