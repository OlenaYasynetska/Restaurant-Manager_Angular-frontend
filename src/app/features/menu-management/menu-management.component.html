<div class="max-w-7xl mx-auto">
  <div class="mb-8 flex justify-between items-center">
    <div>
      <h1 class="text-3xl font-bold text-gray-800 mb-2">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é</h1>
      <p class="text-gray-600">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª—é–¥, –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ü–µ–Ω</p>
    </div>
    <button
      (click)="openCreateModal()"
      class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition font-medium flex items-center gap-2"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
      </svg>
      –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ
    </button>
  </div>

  <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
  <div class="mb-6 flex gap-2 flex-wrap">
    <button
      (click)="selectedCategory = 'all'"
      [class]="'px-4 py-2 rounded-lg font-medium transition ' + 
        (selectedCategory === 'all' 
          ? 'bg-blue-600 text-white' 
          : 'bg-white text-gray-700 hover:bg-gray-100')"
    >
      –í—Å–µ
    </button>
    <button
      *ngFor="let cat of categories"
      (click)="selectedCategory = cat.value"
      [class]="'px-4 py-2 rounded-lg font-medium transition ' + 
        (selectedCategory === cat.value 
          ? 'bg-blue-600 text-white' 
          : 'bg-white text-gray-700 hover:bg-gray-100')"
    >
      {{ cat.label }}
    </button>
  </div>

  <!-- –°–ø–∏—Å–æ–∫ –±–ª—é–¥ -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div
      *ngFor="let item of getFilteredItems(menuItems$ | async)"
      class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition"
    >
      <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
      <div class="h-48 relative overflow-hidden">
        <!-- –ï—Å–ª–∏ –µ—Å—Ç—å URL —Ñ–æ—Ç–æ -->
        <img 
          *ngIf="item.imageUrl" 
          [src]="item.imageUrl" 
          [alt]="item.name"
          class="w-full h-full object-cover"
        />
        <!-- –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -->
        <div 
          *ngIf="!item.imageUrl" 
          class="w-full h-full bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center"
        >
          <span class="text-6xl">üçΩÔ∏è</span>
        </div>
        
        <div
          *ngIf="!item.available"
          class="absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded"
        >
          –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ
        </div>
      </div>

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div class="p-4">
        <div class="mb-2">
          <span class="text-xs text-gray-500">{{ item.category }}</span>
        </div>
        <h3 class="text-lg font-semibold text-gray-800 mb-2">{{ item.name }}</h3>
        <p class="text-sm text-gray-600 mb-3 line-clamp-2">{{ item.description }}</p>
        
        <div class="flex items-center justify-between mb-4">
          <div class="text-xl font-bold text-gray-900">{{ formatPrice(item.price) }}</div>
          <div class="text-sm text-gray-500">
            <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            {{ item.preparationTime }} –º–∏–Ω
          </div>
        </div>

        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <div class="flex gap-2">
          <button
            (click)="toggleAvailability(item)"
            [class]="'flex-1 px-3 py-2 rounded-lg transition text-sm font-medium ' +
              (item.available 
                ? 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200' 
                : 'bg-green-100 text-green-700 hover:bg-green-200')"
          >
            {{ item.available ? 'üö´ –í—ã–∫–ª.' : '‚úì –í–∫–ª.' }}
          </button>
          <button
            (click)="openEditModal(item)"
            class="flex-1 bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-2 rounded-lg transition text-sm font-medium"
          >
            ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
          </button>
          <button
            (click)="deleteItem(item)"
            class="bg-red-100 text-red-700 hover:bg-red-200 px-3 py-2 rounded-lg transition text-sm font-medium"
          >
            üóëÔ∏è
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div
    *ngIf="showModal"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"
    (click)="closeModal()"
  >
    <div
      class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      (click)="$event.stopPropagation()"
    >
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="border-b px-6 py-4 flex justify-between items-center">
        <h2 class="text-2xl font-bold text-gray-800">
          {{ editingItem ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª—é–¥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ' }}
        </h2>
        <button
          (click)="closeModal()"
          class="text-gray-400 hover:text-gray-600 transition"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- –§–æ—Ä–º–∞ -->
      <form (ngSubmit)="saveItem()" class="p-6">
        <div class="space-y-4">
          <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              –ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞ <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              [(ngModel)]="formData.name"
              name="name"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°—Ç–µ–π–∫ –†–∏–±–∞–π"
            />
          </div>

          <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              –ö–∞—Ç–µ–≥–æ—Ä–∏—è <span class="text-red-500">*</span>
            </label>
            <select
              [(ngModel)]="formData.category"
              name="category"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
            >
              <option *ngFor="let cat of categories" [value]="cat.value">
                {{ cat.label }}
              </option>
            </select>
          </div>

          <!-- –¶–µ–Ω–∞ –∏ –≤—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                –¶–µ–Ω–∞ (‚Ç¨) <span class="text-red-500">*</span>
              </label>
              <input
                type="number"
                [(ngModel)]="formData.price"
                name="price"
                required
                min="0"
                step="0.01"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                placeholder="0"
              />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                –í—Ä–µ–º—è (–º–∏–Ω)
              </label>
              <input
                type="number"
                [(ngModel)]="formData.preparationTime"
                name="preparationTime"
                min="1"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                placeholder="15"
              />
            </div>
          </div>

          <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              –û–ø–∏—Å–∞–Ω–∏–µ
            </label>
            <textarea
              [(ngModel)]="formData.description"
              name="description"
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none"
              placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –±–ª—é–¥–∞..."
            ></textarea>
          </div>

          <!-- –§–æ—Ç–æ –±–ª—é–¥–∞ -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              –§–æ—Ç–æ –±–ª—é–¥–∞
            </label>
            
            <!-- –ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ -->
            <div *ngIf="formData.imageUrl" class="mb-3 relative">
              <img 
                [src]="formData.imageUrl" 
                alt="–ü—Ä–µ–≤—å—é" 
                class="w-full h-48 object-cover rounded-lg border-2 border-gray-300"
              />
              <button
                type="button"
                (click)="removePhoto()"
                class="absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="flex items-center gap-3">
              <label class="flex-1 cursor-pointer">
                <div class="flex items-center justify-center gap-2 px-4 py-3 bg-blue-50 hover:bg-blue-100 border-2 border-blue-300 border-dashed rounded-lg transition text-blue-700 font-medium">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                  {{ formData.imageUrl ? '–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ' : '–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ' }}
                </div>
                <input
                  type="file"
                  accept="image/*"
                  (change)="onFileSelected($event)"
                  class="hidden"
                />
              </label>
            </div>
            <p class="text-xs text-gray-500 mt-2">
              –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5MB. –ï—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∏–∫–æ–Ω–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é üçΩÔ∏è
            </p>
          </div>

          <!-- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å -->
          <div class="flex items-center gap-3">
            <input
              type="checkbox"
              [(ngModel)]="formData.available"
              name="available"
              id="available"
              class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
            />
            <label for="available" class="text-sm font-medium text-gray-700">
              –ë–ª—é–¥–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –∑–∞–∫–∞–∑–∞
            </label>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="flex gap-3 mt-6">
          <button
            type="button"
            (click)="closeModal()"
            class="flex-1 px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition font-medium"
          >
            –û—Ç–º–µ–Ω–∞
          </button>
          <button
            type="submit"
            class="flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition font-medium"
          >
            {{ editingItem ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
